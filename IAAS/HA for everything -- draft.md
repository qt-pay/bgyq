## HA for everything -- draft

任何平台、软件和方案的高可用都得从这些方面考虑。

### 两地三中心平台高可用

数据的复制只是HA的最基础，数据能被业务系统所识别才能支撑上层的双活。

#### 仲裁节点 and 脑裂

一套云平台（基于k8s）管理两个数据中心云资源：云平台采用**2+2+1**高可用模式进行部署，两个数据中心各部署两个管理业务节点，1个仲裁节点部署在第三机房。单节点故障无影响；数据中心故障云管理平台可快速恢复，**RPO=0**（数据恢复），**RTO**分钟级；

网络一波动仲裁节点一挂立马就脑裂了，往往数据中心中的网络没有想象中的那么稳定

主备，冷备，最容易实现，但是要实现数据的自动恢复和切换。

* 主日常同步数据到备，备恢复全部主中心数据怎么恢复
* 备中心运行期间有增量数据怎么同步给主中心

### 存储

#### DRBD：网络Raid 1

DRBD的英文全称是Distributed Replicated Block Deivce(分布式块设备复制)，是linux内核的存储层一个分布式存储系统。可以利用DRBD在两台服务器之间共享块设备，文件系统和数据。类似于一个网络RAID1的功能。

#### ceph

rbd 和cephFS

#### 备份

保障Recovery Time Objective，恢复时间目标。

### 硬件网络

#### 网卡bond

物理机高可用及host上vm的网络高可用

#### M

交换机链路高可用

### 软件网络

#### keepalived/vrrp

vip 高可用

### 计算

#### 无状态设计

### 监控

监控的高可用又要从 存储、计算和HA考虑。