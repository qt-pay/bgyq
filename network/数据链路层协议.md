## 数据链路层协议

### Ethernet

#### MAC



### P2P

    P2P 就是 peer-to-peer。这种方式的特点是，资源一开始并不集中存储在某些设备上，而是分散地存储在多台设备上，这些设备我们称为 peer。

    在下载一个文件时，只要得到那些已经存在了文件的 peer 地址，并和这些 peer 建立点对点的连接，就可以就近下载文件，而不需要到中心服务器上。一旦下载了文件，你的设备也就称为这个网络的一个 peer，你旁边的那些机器也可能会选择从你这里下载文件。

    通过这种方式解决上面 C/S 结构单一服务器带宽压力问题。如果使用过 P2P2 软件，例如 BitTorrent，你就会看到自己网络不仅有下载流量，还有上传流量，也就是说你加入了这个 P2P 网络，自己可以从这个网络里下载，同时别人也可以从你这里下载。这样就实现了，**下载人数越多，下载速度越快的愿望**。

#### 种子文件（.torent）

    上面整个过程是不是很完美？是的，结果很美好，但为了实现这个美好，我们还是有很多准备工作要做的。比如，我们怎么知道哪些 peer 有某个文件呢？

    这就用到我们常说的**种子（.torrent）**。 .torrent 文件由**Announce（Tracker URL）**和**文件信息**两部分组成。

    其中，文件信息里有以下内容：

- **Info 区**：指定该种子包含的文件数量、文件大小及目录结构，包括目录名和文件名；
- **Name 字段**：指定顶层目录名字；
- **每个段的大小**：BitTorrent（BT）协议把一个文件分成很多个小段，然后分段下载；
- **段哈希值**：将整个种子种，每个段的 SHA-1 哈希值拼在一起。

    下载时，BT 客户端首先解析 .torrent 文件，得到 Tracker 地址，然后连接 Tracker 服务器。Tracker 服务器回应下载者的请求，将其他下载者（包括发布者）的 IP 提供给下载者。

    下载者再连接其他下载者，根据 .torrent 文件，两者分别对方自己已经有的块，然后交换对方没有的数据。

    可以看到，下载的过程不需要其他服务器参与，并分散了单个线路上的数据流量，减轻了服务器的压力。

    下载者每得到一个块，需要算出下载块的 Hash 验证码，并与 .torrent 文件中的进行对比。如果一样，说明块正确，不一样就需要重新下载这个块。这种规定是为了解决下载内容的准确性问题。

    从这个过程也可以看出，这种方式特别依赖 Tracker。Tracker 需要收集所有 peer 的信息，并将从信息提供给下载者，使下载者相互连接，传输数据。虽然下载的过程是非中心化的，但是加入这个 P2P 网络时，需要借助 Tracker 中心服务器，这个服务器用来登记有哪些用户在请求哪些资源。

    所以，这种工作方式有一个弊端，一旦 Tracker 服务器出现故障或者线路被屏蔽，BT 工具就无法正常工作了。

### Boradcast网络

#### Ethernet链路



### NBMA网络

全互联

#### DLCT

### P2MP网络









### 引用

1. https://zhuanlan.zhihu.com/p/87327257
2. 

